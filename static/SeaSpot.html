<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>海水浴場４</title>
        <link rel="stylesheet" href="./css/Sea.css">

        <script type="module">
            import{fetchJSON}from "https://js.sabae.cc/fetchJSON.js";
            import { enc } from "https://js.sabae.cc/enc.js";

            var selected = []
            window.onload=async()=>{
                const load=async()=>{
                    var Params = new URLSearchParams(window.location.search);
                    var which = Params.get('name')

                    if (which == "beach"){
                        document.getElementById("riverspot").style.display = "none";
                        selected.push("beach")
                        
                    }else if (which == "river"){
                        document.getElementById("seaspot").style.display = "none";
                        selected.push("river")
                        
                    }
                
                    const data=await fetchJSON("/api/get-allID",which);
                    container.innerHTML="";
                    console.log(data)
                    if(data!="warning"){
                        for(const d of data){
                            const div=document.createElement("div");
                            div.className="btn-id";
                            div.innerHTML=`<h1><span class=name>${(d.name)}</span></h1>
                                <img src=${(d.img)} width="30%"><br> <span class=info>${d.info}</span>
                                <br><button class=btn-id id=${d.ID}>${(d.name)}</button>`
                        //   container.appendChild(div);
                        document.body.appendChild(div);
                            }
                    }else{
                        const div=document.createElement("div");
                        div.className="warning";
                        div.innerHTML=`warning<br>data is not found.`
                        container.appendChild(div);
                    }
                }
                load();
            }
  
//ボタンが押されたら、押されたボタンのIDを返す
   document.addEventListener('DOMContentLoaded',function(){
    var btns = document.querySelectorAll('.btn-id');
    for(var i = 0; i < btns.length; i++){
        btns[i].addEventListener('click',function(){
            alert('ID:'+this.id+'が選ばれました');
            console.log(this.id);
            selected.push(this.id);
//詳細ページのID乗っけて飛ぶ
            console.log(selected)
            var attr =this.id;
            //あってる？
            
                window.location.href="detail.html?type= " + selected;
        
            },false);
    }
},false);



        </script>


    </head>
    <body>
            

        <!--ボタン作って、タイプとIDをdetail.htmlに返す-->
        <main>
            
                <div id=container></div>
                <!--名前は仮置き、おいおいサーバーから名前もらってくるように-->
                <div id="seaspot">
                    <button class="btn-id" id="1"><a>1:浜地海水浴場</a></button>
                    <button class="btn-id" id="2"><a>2:三国ビーチ</a></button>
                    <button class="btn-id" id="3"><a>3:高巣海水浴場</a></button>
                    <button class="btn-id" id="4"><a>4:ワサダワダ</a></button>
                </div>
                <div id="riverspot">
                    <button class="btn-id" id="1"><a>1:a</a></button>
                    <button class="btn-id" id="2"><a>2:b</a></button>
                    <button class="btn-id" id="3"><a>3:c</a></button>
                    <button class="btn-id" id="4"><a>4:d</a></button>
                </div>

        </main>

        <a href="board.html"><h1>掲示板</h1></a>
    </body>
    
</html>